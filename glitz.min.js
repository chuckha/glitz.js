/**  glitz.js v0.1.2 Â© 2012 Daniel Mendel Espeset | MIT license **/
(function(l){function m(){return function(a){return this instanceof arguments.callee?"function"==typeof this.init?this.init.apply(this,a&&a.callee?a:arguments):!1:new arguments.callee(arguments)}}function n(a,b){for(var c=0,d=a&&a.length?a.length:a,e,c=0;c<d&&!(e="number"===typeof a?c:a[c],e=b(e),e="undefined"===typeof e?!0:e,!e);c++);}function j(a,b){for(var c in a)o.call(a,c)&&b.call(a,c)}function q(a){var b,c;/^\s?[0-9]*,[0-9]*,[0-9]*/.exec(a)&&(a="rgba("+a+")");if(b=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(a))c=
[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),1];else if(b=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(a))c=[17*parseInt(b[1],16),17*parseInt(b[2],16),17*parseInt(b[3],16),1];else if(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))c=[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),1];else if(b=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(a))c=[parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),parseFloat(b[4])];return c}
function r(a,b,c){j(b,function(d){return"object"===typeof b[d]?r(a[d],b[d],c[d]):a[d]=c[d]})}function s(a,b){j(a,function(c){switch(typeof a[c]){case "string":if(a[c].match(/^\+/))return a[c]=b[c]+parseFloat(a[c].replace(/^\+/,""));if(a[c].match(/^-/))return a[c]=b[c]-parseFloat(a[c].replace(/^\-/,""));if(a[c].match(/^(#|rgb)/))return a[c]=q(a[c]),b[c]=q(b[c]);break;case "object":s(a[c],b[c])}})}var o=Object.prototype.hasOwnProperty,k=m(),p=m(),t=m();l.animations=[];k.prototype={to:{},from:{},renderable:null,
easing:"easeOutQuad",duration:0,startAt:null,endAt:null,finished:!1,eachFrame:null,done:null,init:function(a,b){this.duration=b.duration||0;this.startAt=(new Date).getTime();this.endAt=this.startAt+this.duration;this.done=b.done||null;this.to=b.to||{};this.easing=b.easing||this.easing;this.renderable=a;o.call(this.renderable,"engine")&&this.renderable.engine.registerAnimation();this.from={};r(this.from,this.to,a);s(this.to,this.from);l.animations.push(this);return this},step:function(){var a=this.endAt-
(new Date).getTime(),b=this.renderable,c=this.to,d=this.from,e=this.duration,f=this.easing;if(1>=a)return this.stop(),!1;(function u(b,c,d){j(b,function(g){return"object"===typeof b[g]?b[g]instanceof Array&&4===b[g].length?d[g]="rgba("+parseInt(i[f](e-a,c[g][0],b[g][0]-c[g][0],e))+","+parseInt(i[f](e-a,c[g][1],b[g][1]-c[g][1],e))+","+parseInt(i[f](e-a,c[g][2],b[g][2]-c[g][2],e))+","+i[f](e-a,c[g][3],b[g][3]-c[g][3],e)+")":u(b[g],c[g],d[g]):d[g]=i[f](e-a,c[g],b[g]-c[g],e)})})(c,d,b);return!0},stop:function(){var a=
this.renderable;(function c(a,e){j(e,function(f){return"object"===typeof e[f]?e[f]instanceof Array&&4===e[f].length?a[f]="rgba("+parseInt(e[f][0])+","+parseInt(e[f][1])+","+parseInt(e[f][2])+","+parseFloat(e[f][3])+")":c(a[f],e[f]):a[f]=e[f]})})(a,this.to);"function"===typeof this.done&&this.done.call(a,this);o.call(a,"engine")&&a.engine.unregisterAnimation();return this.finished=!0}};p.prototype={x:0,y:0,scale:1,engine:null,length:0,_id:-1,animation:!1,init:function(a){var b=this,a=a||{};j(a,function(c){b[c]=
a[c]})},setup:function(a){a.translate(this.x,this.y);a.scale(this.scale,this.scale)},render:function(){},push:function(a){a.parent=this;a.registerEngine(this.engine);Array.prototype.push.call(this,a);a._id=this.length-1},registerEngine:function(a){this.engine=a;n(this,function(b){b.registerEngine(a)})},removeChild:function(a){Array.prototype.splice.call(this,a._id,1);n(this,function(b){b._id>a._id&&b._id++})},remove:function(){this.parent.removeChild(this);return this},animate:function(a,b,c){(new Date).getTime();
var d={};"number"===typeof b?(d.duration=b,d.done=c||function(){}):d={duration:b.duration||250,done:b.done||function(){},easing:b.easing||"easeOutQuad"};"function"===typeof b&&(d.done=b);"function"===typeof c&&(d.done=c);d.to=a;delete this.animation;this.animation=new k(this,d)},draw:function(a){var a=a||this.engine.ctx,b=this.animation;a.save();b&&!b.finished&&b.step();this.setup(a);this.render(a);n(this,function(b){b.draw(a)});a.restore()}};t.prototype={_dirty:!0,FPS:1E3/60,runningAnimations:0,
canvas:null,ctx:null,layout:null,running:!1,init:function(a){this.canvas="undefined"!==typeof window.jQuery?jQuery(a)[0]:a;this.ctx=this.canvas.getContext("2d");this.layout=new p({engine:this,width:this.canvas.width,height:this.canvas.height,backgroundColor:"#fff",clearFrames:!0,background:function(){},setup:function(a){a.fillStyle=this.backgroundColor;this.clearFrames&&a.fillRect(-1,-1,this.width+1,this.height+1);this.background(a);a.translate(this.x,this.y);a.scale(this.scale,this.scale)}});this.start()},
dirty:function(){this._dirty||(this._dirty=!0,this.start())},clean:function(){this._dirty=!1;this.stop()},start:function(){var a=this;a.running||(new Date).getTime();a.running=setInterval(function(){return a._dirty?(a.layout.draw(),1>a.runningAnimations?a.clean():null):a.clean()},a.FPS)},stop:function(){clearInterval(this.running);this.running=!1},registerAnimation:function(){this.runningAnimations++;this.dirty();return!0},unregisterAnimation:function(){this.runningAnimations--;return!0},push:function(a){this.layout.push(a);
this.dirty()},setSize:function(a,b){var c=this.layout,d=this.canvas;c.width=d.width=a;c.height=d.height=b},fps:function(a){this.FPS=1E3/a;this.running&&(this.stop(),this.start())}};var i=k.easingLib={easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInCubic:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOutCubic:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},
easeInOutCubic:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b},easeInQuart:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOutQuart:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOutQuart:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOutQuint:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeInOutQuint:function(a,b,c,d){return 1>(a/=d/2)?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+
2)+b},easeInSine:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},easeOutSine:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},easeInOutSine:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},easeInExpo:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOutExpo:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOutExpo:function(a,b,c,d){return 0==a?b:a==d?b+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(a,
b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOutCirc:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInOutCirc:function(a,b,c,d){return 1>(a/=d/2)?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(a,b,c,d){var e=1.70158,f=0,h=c;if(0==a)return b;if(1==(a/=d))return b+c;f||(f=0.3*d);h<Math.abs(c)?(h=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*d-e)*2*Math.PI/f))+b},easeOutElastic:function(a,b,c,d){var e=1.70158,
f=0,h=c;if(0==a)return b;if(1==(a/=d))return b+c;f||(f=0.3*d);h<Math.abs(c)?(h=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/h);return h*Math.pow(2,-10*a)*Math.sin((a*d-e)*2*Math.PI/f)+c+b},easeInOutElastic:function(a,b,c,d){var e=1.70158,f=0,h=c;if(0==a)return b;if(2==(a/=d/2))return b+c;f||(f=d*0.3*1.5);h<Math.abs(c)?(h=c,e=f/4):e=f/(2*Math.PI)*Math.asin(c/h);return 1>a?-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*d-e)*2*Math.PI/f)+b:0.5*h*Math.pow(2,-10*(a-=1))*Math.sin((a*d-e)*2*Math.PI/f)+c+b},easeInBack:function(a,
b,c,d,e){void 0==e&&(e=1.70158);return c*(a/=d)*a*((e+1)*a-e)+b},easeOutBack:function(a,b,c,d,e){void 0==e&&(e=1.70158);return c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOutBack:function(a,b,c,d,e){void 0==e&&(e=1.70158);return 1>(a/=d/2)?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},easeInBounce:function(a,b,c,d){return c-i.easeOutBounce(d-a,0,c,d)+b},easeOutBounce:function(a,b,c,d){return(a/=d)<1/2.75?c*7.5625*a*a+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+0.75)+b:a<2.5/2.75?c*(7.5625*
(a-=2.25/2.75)*a+0.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+0.984375)+b},easeInOutBounce:function(a,b,c,d){return a<d/2?0.5*i.easeInBounce(2*a,0,c,d)+b:0.5*i.easeOutBounce(2*a-d,0,c,d)+0.5*c+b}};l.glitz={Animation:k,Renderable:p,Engine:t,version:"0.1.2"}})(window);
/** glitz.js v0.3 http://github.com/danielmendel/glitz.js/license.txt **/!function(){var a=["ms","moz","webkit","o"];for(var b=0;b<a.length&&!window.requestAnimationFrame;++b)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"];window.requestAnimationFrame=window.requestAnimationFrame||function(){}}(),!function(a){function d(){return function(a){return this instanceof arguments.callee?typeof this.init=="function"?this.init.apply(this,a&&a.callee?a:arguments):!1:new arguments.callee(arguments)}}function e(a,b){var c=0,d=a&&a.length?a.length:a,e,f=typeof a=="number";for(c=0;c<d;c++){e=b(f?c:a[c],c);if(typeof e=="undefined"?!1:!e)break}}function f(a,b){for(var d in a)c.call(a,d)&&b.call(a,d)}function g(a){if(a instanceof Array){var b=[];e(a,function(a){b.push(g(a))})}else{var b={};f(a,function(c){b[c]=typeof a[c]!="object"?a[c]:g(a[c])})}return b}function h(a){var b,c;if(b=/^\s?[0-9]*,[0-9]*,[0-9]*/.exec(a))a="rgba("+a+")";if(b=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/.exec(a))c=[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),1];else if(b=/#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])/.exec(a))c=[parseInt(b[1],16)*17,parseInt(b[2],16)*17,parseInt(b[3],16)*17,1];else if(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))c=[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),1];else if(b=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9\.]*)\s*\)/.exec(a))c=[parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),parseFloat(b[4])];return c}function i(a,b,c){f(b,function(d){return typeof b[d]=="object"?i(a[d],b[d],c[d]):a[d]=c[d]})}function j(a,b){f(a,function(c){switch(typeof a[c]){case"string":if(a[c].match(/^\+/))return a[c]=b[c]+parseFloat(a[c].replace(/^\+/,""));if(a[c].match(/^-/))return a[c]=b[c]-parseFloat(a[c].replace(/^\-/,""));if(a[c].match(/^(#|rgb)/))return a[c]=h(a[c]),b[c]=h(b[c]);break;case"object":j(a[c],b[c]);break;default:}})}function n(a){function e(a){var b=[],c=new d,e=1;while(e++<arguments.length)c.push(arguments[e]);c.animations=[];if(!arguments.length)return c;for(k in a)a.hasOwnProperty(k)&&(c[k]=a[k]);return c}var b="___glitzBorrowedArray";while(window.hasOwnProperty(b))b="___glitzBorrowedArray"+Math.floor(100+Math.random()*200)+(new Date).getTime();var c=document.createElement("iframe");c.style.display="none",document.body.appendChild(c),frames[frames.length-1].document.write("<script>parent."+b+" = Array;</script>");var d=window[b];delete window[b];for(k in m)m.hasOwnProperty(k)&&(d.prototype[k]=m[k]);for(k in a)a.hasOwnProperty(k)&&(d.prototype[k]=a[k]);return e.Array=d,e}var b={defaultEasing:"easeOutQuad"},c=Object.prototype.hasOwnProperty,l=d();l.prototype={to:{},from:{},renderable:null,easing:b.defaultEasing,duration:0,startAt:null,endAt:null,finished:!1,eachFrame:null,done:null,init:function(a,b){var d=this;return d.duration=b.duration||0,d.startAt=(new Date).getTime(),d.endAt=d.startAt+d.duration,d.done=b.done||null,d.to=b.to||{},d.easing=b.easing||d.easing,d.renderable=a,c.call(d.renderable,"engine")?d.renderable.engine.registerAnimation():0,d.from={},i(d.from,d.to,a),j(d.to,d.from),this},step:function(){var a=this,b=(new Date).getTime(),c=a.endAt-b,d=1/(a.duration/c),e=a.renderable,g=a.to,h=a.from,i=a.duration,j=a.easing;return c<=1?(a.stop(),!1):(!function k(a,b,d){f(a,function(e){return typeof a[e]=="object"?a[e]instanceof Array&&a[e].length===4?d[e]="rgba("+parseInt(p[j](i-c,b[e][0],a[e][0]-b[e][0],i))+","+parseInt(p[j](i-c,b[e][1],a[e][1]-b[e][1],i))+","+parseInt(p[j](i-c,b[e][2],a[e][2]-b[e][2],i))+","+p[j](i-c,b[e][3],a[e][3]-b[e][3],i)+")":k(a[e],b[e],d[e]):d[e]=p[j](i-c,b[e],a[e]-b[e],i)})}(g,h,e),!0)},stop:function(){var a=this,b=a.to,d=a.renderable;return!function e(a,b){f(b,function(c){return typeof b[c]=="object"?b[c]instanceof Array&&b[c].length===4?a[c]="rgba("+parseInt(b[c][0])+","+parseInt(b[c][1])+","+parseInt(b[c][2])+","+parseFloat(b[c][3])+")":e(a[c],b[c]):a[c]=b[c]})}(d,b),typeof a.done=="function"&&a.done.call(d,a),c.call(d,"engine")?d.engine.unregisterAnimation():0,a.finished=!0}};var m={x:0,y:0,scale:1,engine:null,_id:-1,animations:[],init:function(a){var b=this,a=a||{};f(a,function(c){b[c]=a[c]})},setup:function(a){a.translate(this.x,this.y),a.scale(this.scale,this.scale)},render:function(a){},push:function(a){a.parent=this,a.registerEngine(this.engine),Array.prototype.push.call(this,a),a._id=this.length-1},registerEngine:function(a){this.engine=a,e(this,function(b){b.registerEngine(a)})},removeChild:function(a){Array.prototype.splice.call(this,a._id,1),e(this,function(b){b._id>a._id&&b._id++})},remove:function(){return this.parent.removeChild(this),this},animateSeries:function(a){if(!a.length)return!1;var b=this,c=a.shift(),d=c.done;return c instanceof Array?b.animateParallel(c,function(){b.animateSeries(a)}):(c.done=function(){b.animateSeries(a),d&&d.call(this)},b.animations.push(new l(b,c)))},animateParallel:function(a,b){var c=this;a.sort(function(a,b){return a.duration<b.duration});var d={duration:0};!function g(a){e(a,function(a){if(a instanceof Array)return g(a);d=a.duration>d.duration?a:d})}(a);var f=d.done;return d.done=function(){b.call(this),f&&f.call(this)},e(a,function(a,d){if(a instanceof Array)return c.animateSeries(a,b);c.animations.push(new l(c,a))}),!0},animate:function(a,b,c){var d={};this.animations.length=0;if(a instanceof Array)return this.animateSeries(g(a));typeof b=="number"?(d.duration=b,d.done=arguments[2]||function(){}):d={duration:b.duration||250,done:b.done||function(){},easing:b.easing||glitz.config.defaultEasing},typeof b=="function"&&(d.done=b),typeof c=="function"&&(d.done=c),d.to=a,this.animations.push(new l(this,d))},draw:function(a){var b=this,a=a||b.engine.ctx,c=b.animations;a.save();var d=[];c.length&&e(c,function(a,b){a.finished?d.push(b):a.step()}),e(d.reverse(),function(a){c.splice(a,1)}),b.setup(a),b.render(a),e(b,function(b){b.draw(a)}),a.restore()}},o=d();o.prototype={_dirty:!0,FPS:1e3/60,runningAnimations:0,canvas:null,ctx:null,layout:null,running:!1,init:function(a){var b=this;b.canvas=typeof window.jQuery!="undefined"?jQuery(a)[0]:a,b.ctx=b.canvas.getContext("2d"),b.layout=new(n({engine:b,width:b.canvas.width,height:b.canvas.height,backgroundColor:"#fff",clearFrames:!0,background:function(a){},setup:function(a){a.fillStyle=this.backgroundColor,this.clearFrames&&a.fillRect(-1,-1,this.width+1,this.height+1),this.background(a),a.translate(this.x,this.y),a.scale(this.scale,this.scale)}}));var c=-1;requestAnimationFrame(function d(){c<0&&b.start(),clearTimeout(c),c=setTimeout(function(){c=-1,b.stop()},100),requestAnimationFrame(d)})},dirty:function(){this._dirty||(this._dirty=!0,this.start())},clean:function(){this._dirty&&(this._dirty=!1,this.stop())},start:function(){var a=this;a.running||(a.running=setInterval(function(){return a._dirty?(a.layout.draw(),a.runningAnimations<1?a.clean():null):a.clean()},a.FPS))},stop:function(){clearInterval(this.running),this.running=!1},registerAnimation:function(){return this.runningAnimations++,this.dirty(),!0},unregisterAnimation:function(){return this.runningAnimations--,!0},push:function(a){this.layout.push(a),this.dirty()},setSize:function(a,b){var c=this.layout,d=this.canvas;c.width=d.width=a,c.height=d.height=b},fps:function(a){this.FPS=1e3/a,this.running&&(this.stop(),this.start())}};var p=l.easingLib={easeInQuad:function(a,b,c,d){return c*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},easeInCubic:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOutCubic:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},easeInOutCubic:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b},easeInQuart:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOutQuart:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOutQuart:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOutQuint:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeInOutQuint:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},easeOutSine:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},easeInOutSine:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b},easeInExpo:function(a,b,c,d){return a==0?b:c*Math.pow(2,10*(a/d-1))+b},easeOutExpo:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOutExpo:function(a,b,c,d){return a==0?b:a==d?b+c:(a/=d/2)<1?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOutCirc:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInOutCirc:function(a,b,c,d){return(a/=d/2)<1?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(a==0)return b;if((a/=d)==1)return b+c;f||(f=d*.3);if(g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin((a*d-e)*2*Math.PI/f))+b},easeOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(a==0)return b;if((a/=d)==1)return b+c;f||(f=d*.3);if(g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return g*Math.pow(2,-10*a)*Math.sin((a*d-e)*2*Math.PI/f)+c+b},easeInOutElastic:function(a,b,c,d){var e=1.70158,f=0,g=c;if(a==0)return b;if((a/=d/2)==2)return b+c;f||(f=d*.3*1.5);if(g<Math.abs(c)){g=c;var e=f/4}else var e=f/(2*Math.PI)*Math.asin(c/g);return a<1?-0.5*g*Math.pow(2,10*(a-=1))*Math.sin((a*d-e)*2*Math.PI/f)+b:g*Math.pow(2,-10*(a-=1))*Math.sin((a*d-e)*2*Math.PI/f)*.5+c+b},easeInBack:function(a,b,c,d,e){return e==undefined&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b},easeOutBack:function(a,b,c,d,e){return e==undefined&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOutBack:function(a,b,c,d,e){return e==undefined&&(e=1.70158),(a/=d/2)<1?c/2*a*a*(((e*=1.525)+1)*a-e)+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},easeInBounce:function(a,b,c,d){return c-p.easeOutBounce(d-a,0,c,d)+b},easeOutBounce:function(a,b,c,d){return(a/=d)<1/2.75?c*7.5625*a*a+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},easeInOutBounce:function(a,b,c,d){return a<d/2?p.easeInBounce(a*2,0,c,d)*.5+b:p.easeOutBounce(a*2-d,0,c,d)*.5+c*.5+b}};a.glitz={Animation:l,Renderable:n,Engine:o,version:"0.1.2",config:b}}(window);